module.exports=function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([,function(e,t){e.exports=flarum.core.compat["forum/app"]},function(e,t){e.exports=flarum.core.compat["common/extend"]},function(e,t){e.exports=flarum.core.compat["tags/models/Tag"]},function(e,t){e.exports=flarum.core.compat["common/Model"]},function(e,t){e.exports=flarum.core.compat["common/utils/Stream"]},function(e,t){e.exports=flarum.core.compat["forum/components/SettingsPage"]},,function(e,t){e.exports=flarum.core.compat["common/utils/string"]},function(e,t){e.exports=flarum.core.compat["common/components/Switch"]},function(e,t){e.exports=flarum.core.compat["forum/states/DiscussionListState"]},function(e,t){e.exports=flarum.core.compat["forum/components/DiscussionListItem"]},function(e,t){e.exports=flarum.core.compat["common/components/FieldSet"]},function(e,t){e.exports=flarum.core.compat["common/utils/ItemList"]},function(e,t,n){"use strict";n.r(t);var s=n(1),o=n.n(s),r=n(2),i=n(10),c=n.n(i),a=n(11),p=n.n(a),u=n(8),l=n(3),f=n.n(l),d=n(4),x=n.n(d);function h(e){var t=e.replace(/(<\/p>|<br>)/g,"$1 &nbsp;").replace(/<img\b[^>]*>/gi," "),n=(new DOMParser).parseFromString(t,"text/html").documentElement;return h.removeSelectors.forEach((function(e){n.querySelectorAll(e).forEach((function(e){e.remove()}))})),n.innerText.replace(/\s+/g," ").trim()}h.removeSelectors=["blockquote","script"];var y=n(6),b=n.n(y),g=n(12),S=n.n(g),v=n(13),w=n.n(v),E=n(9),O=n.n(E),M=n(5),P=n.n(M);o.a.initializers.add("ianm-synopsis",(function(){o.a.initializers.has("flarum-tags")&&(f.a.prototype.richExcerpts=x.a.attribute("richExcerpts"),f.a.prototype.excerptLength=x.a.attribute("excerptLength")),Object(r.extend)(c.a.prototype,"requestParams",(function(e){"first"===o.a.forum.attribute("synopsis.excerpt_type")?e.include.push("firstPost"):e.include.push("lastPost")})),Object(r.extend)(p.a.prototype,"infoItems",(function(e){var t,n,s,r,i=this.attrs.discussion;if(!o.a.session.user||o.a.session.user.preferences().showSynopsisExcerpts){var c,a=i.tags();a&&(c=a[a.length-1]);var p="first"===o.a.forum.attribute("synopsis.excerpt_type")?i.firstPost():i.lastPost(),l="number"==typeof(null==(t=c)?void 0:t.excerptLength())?null==(n=c)?void 0:n.excerptLength():o.a.forum.attribute("synopsis.excerpt_length"),f="number"==typeof(null==(s=c)?void 0:s.richExcerpts())?null==(r=c)?void 0:r.richExcerpts():o.a.forum.attribute("synopsis.rich_excerpts"),d=!!o.a.session.user&&o.a.session.user.preferences().showSynopsisExcerptsOnMobile;if(0!==l&&null!=p&&null!=p.contentHtml&&p.contentHtml()){var x=f?m.trust(Object(u.truncate)(null==p||null==p.contentHtml?void 0:p.contentHtml(),l)):Object(u.truncate)(h((null==p||null==p.contentHtml?void 0:p.contentHtml())||(null==p||null==p.oldContentHtml?void 0:p.oldContentHtml())),l);if(p){var y=m("div",{inert:!0},x);e.add(d?"excerptM":"excerpt",y,-100)}}}})),Object(r.extend)(b.a.prototype,"oninit",(function(){this.showSynopsisExcerpts=P()(this.user.preferences().showSynopsisExcerpts),this.showSynopsisExcerptsOnMobile=P()(this.user.preferences().showSynopsisExcerptsOnMobile)})),Object(r.extend)(b.a.prototype,"settingsItems",(function(e){e.add("synopsis",S.a.component({label:o.a.translator.trans("ianm-synopsis.forum.user.settings.summaries-heading"),className:"Settings-Synopsis"},this.summariesItems().toArray()))})),b.a.prototype.summariesItems=function(){var e=this,t=new w.a;return t.add("synopsis-excerpts",O.a.component({state:this.user.preferences().showSynopsisExcerpts,onchange:function(t){e.showSynopsisExcerptsLoading=!0,e.user.savePreferences({showSynopsisExcerpts:t}).then((function(){e.showSynopsisExcerptsLoading=!1,m.redraw()}))},loading:this.showSynopsisExcerptsLoading},o.a.translator.trans("ianm-synopsis.forum.user.settings.show-summaries"))),this.user.preferences().showSynopsisExcerpts&&t.add("synopsis-excerpts-mobile",O.a.component({state:this.user.preferences().showSynopsisExcerptsOnMobile,disabled:!this.user.preferences().showSynopsisExcerpts,onchange:function(t){e.showSynopsisExcerptsOnMobileLoading=!0,e.user.savePreferences({showSynopsisExcerptsOnMobile:t}).then((function(){e.showSynopsisExcerptsOnMobileLoading=!1,window.location.reload()}))},loading:this.showSynopsisExcerptsOnMobileLoading},o.a.translator.trans("ianm-synopsis.forum.user.settings.show-summaries-mobile"))),t}}))}]);
//# sourceMappingURL=forum.js.map